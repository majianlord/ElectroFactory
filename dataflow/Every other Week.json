{
	"name": "Every other Week",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "TRO_Connect_epds01",
						"type": "LinkedServiceReference"
					},
					"name": "Transfer"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "Temp_Files_Locations",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [],
			"scriptLines": [
				"parameters{",
				"     FileNAme as string",
				"}",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'query',",
				"     store: 'sqlserver',",
				"     query: '/* Rev 1 - Set to look back at last 365 days.  Will be running weekly.  Only thing Revenue Analytics might want is unit cost and unit price.  TD 3-16-23\\n*/\\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.trx_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.trx_Qty) as \\'Extended Resale\\', round(-((x.unit_cost / x.unit_price) -1),2) as \\'Margin\\',  \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                           else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\njoin shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  \\n  x.trx_qty > 0 and x.ship_debit_amt = 0 and x.unit_cost <> \\'0\\' and x.unit_price <> \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion\\n-- Regular shipments (cost and resale are both greater than zero) with a ship and debit\\nselect  x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', ((x.unit_cost -(x.ship_debit_amt / x.trx_qty))  * x.trx_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.trx_Qty) as \\'Extended Resale\\', round(-(((x.unit_cost - (x.ship_debit_amt / x.trx_Qty)) / x.unit_price) -1),2) as \\'Margin\\',  \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                           else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\njoin shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.trx_qty > 0 and x.ship_debit_amt <> 0 and x.unit_cost <> \\'0\\' and x.unit_price <> \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion\\n-- Shipment quantity is greater than zero, unit price is greater than zero, cost is zero, margin is 100% on all lines\\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.trx_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.trx_Qty) as \\'Extended Resale\\', \\'100\\' as \\'Margin\\', \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                         else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\njoin shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.trx_qty > 0 and x.unit_cost = \\'0\\' and x.unit_price <> \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and  x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion\\n-- Shipment quantity is greater than zero, unit price is zero, cost is greater than zero, margin is 0% on all lines\\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.trx_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.trx_Qty) as \\'Extended Resale\\', \\'0\\' as \\'Margin\\', \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                           else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\njoin shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.trx_qty > 0 and x.unit_cost > \\'0\\' and x.unit_price = \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion\\n-- Shipment quantity is zero, margin is 0% on all lines, for reporting purposes only\\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.trx_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.trx_Qty) as \\'Extended Resale\\', \\'0\\' as \\'Margin\\', \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                           else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\nleft join shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.trx_qty = 0 and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion \\n-- Credit where order quantity is less than zero, both price and cost do not equal zero \\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.ord_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.ord_Qty) as \\'Extended Resale\\', round(-((x.unit_cost / x.unit_price) -1),2) as \\'Margin\\',  \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                          else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\nleft join shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.ord_qty < 0 and x.unit_Cost <> \\'0\\' and x.unit_price <> \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion \\n-- Credit where order quantity is less than zero, price is zero but unit cost is not zero, margin is 0% on all lines \\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.ord_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.ord_Qty) as \\'Extended Resale\\', \\'0\\' as \\'Margin\\',  \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                         else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\nleft join shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.ord_qty < 0 and x.unit_Cost <> \\'0\\' and x.unit_price = \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\nunion \\n-- Credit where order quantity is less than zero, cost is zero but unit price is not zero, margin is 100% on all lines \\nselect x.inv_trx_rec \\'Inventory Transaction Record\\', x.order_no \\'Order Number\\', x.lin_no \\'Order Line\\', x.trx_date \\'Invoice Date\\', c.cust_name as \\'Customer Name\\', c.cust_no as \\'Customer Number\\',\\n                            case when c.cust_type like \\'A%\\' then \\'Subcontractor\\'\\n                                              when c.cust_type like \\'B%\\' then \\'OEM\\'\\n                                              when (c.cust_type like \\'C%\\' or c.cust_Type like \\'D%\\') then \\'Aftermarket\\'\\n                                              when c.cust_type like \\'E%\\' then \\'Government\\'\\n                                              when c.cust_type like \\'F%\\' then \\'Franchised Distributor\\'\\n                                              when c.cust_type like \\'G%\\' then \\'Broker/Disty Not Franchised\\'\\n                                                       else \\'Other\\' \\n                                                       end as \\'Customer Classification\\',\\ns5.slsman_nam \\'Salesman\\',  case when  h4.ord_type = \\'C\\' then \\'Credit Order\\' else \\'Sales Order\\' end as \\'Order Type\\',  x.item_no as \\'SKU\\', x.manu_no as \\'Manu No\\', x.vend_no as \\'Vend No\\', s.code_desc as \\'Product Type\\', \\n                                               case when d6.pkg_label = \\'NONE\\' then i.uom\\n                                                                when d6.pkg_label = \\'\\' then i.uom\\n                                                                  else d6.pkg_label end as \\'Ship UOM\\'\\n                                                , h.st_city as \\'Ship-to City\\', h.st_state as \\'Ship-to State\\', h.st_cntry as \\'Ship-to Country\\',\\'Electro\\' as \\'Business line\\', x.trx_qty \\'Transaction Quantity\\', (x.unit_cost * x.ord_qty) as \\'Extended Inventory Cost\\', (x.unit_price * x.ord_Qty) as \\'Extended Resale\\', \\'100\\' as \\'Margin\\',  \\'USD\\' as \\'Currency\\', case\\n                           when y.item_no is NULL then \\'Ad-hoc\\'\\n                           else \\'LTA\\'\\n                           end as \\'LTA vs. Ad-hoc\\', case\\n                           when w.stk_item = \\'Y\\' then \\'Stocking\\'\\n                           when x.vend_no like \\'%SHOP%\\' then \\'Resale\\'\\n                           else \\'Purchasing\\'\\n                           end as \\'Inventory type\\',case\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no <> \\'ELEENT\\' then \\'Value-Add Connector\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat = \\'CAB\\' then \\'Cable Assembly\\'\\n                           when x.vend_no like \\'%SHOP%\\' and x.manu_no = \\'ELEENT\\' and i.prod_cat <> \\'CAB\\' then \\'Other Value-Add Assembly\\'\\n                          else \\'Non-VA\\'\\n                           end \\'Distribution Type\\'\\nfrom inv_trx x\\njoin ord_Detl d6 on d6.order_no = x.order_no and d6.lin_no = x.lin_no\\njoin ord_hedr h4 on h4.order_no = x.order_no\\njoin slsman s5 on s5.slsman_no = x.slsman_1 \\njoin customer c on c.cust_no = x.cust_no\\njoin item i on i.item_no = x.item_no and i.manu_no = x.manu_no\\njoin codes s on s.code_id = i.prod_cat and s.code_type = \\'P\\'\\nleft join shp_hedr h on h.ship_no = x.ship_no\\nleft join (select  distinct (d.item_no+d.manu_no+h.cust_no) as \\'contract_identifier\\', h.cust_no, d.item_no, d.manu_no\\n               from ord_detl d\\n                     join ord_hedr h on h.order_no = d.order_no and h.ord_type = \\'N\\'\\n                     where d.status <> \\'V\\' and h.status <> \\'V\\') y on y.cust_no = x.cust_no and y.manu_no = x.manu_no and y.item_no = x.item_no\\nleft join (select distinct (w.item_no+w.manu_no) as \\'stocking_identifier\\', w.item_no, w.manu_no, w.stk_item\\n                     from itm_whse w\\n                     where w.stk_item = \\'Y\\') w on w.item_no = x.item_no and w.manu_no = x.manu_no\\nwhere  x.ord_qty < 0 and x.unit_Cost = \\'0\\' and x.unit_price <> \\'0\\' and x.trx_type = \\'S\\' and x.cust_no not like \\'%SHOP%\\' and x.trx_date between ((getdate() - 365)) and ((getdate()))\\n',",
				"     isolationLevel: 'READ_COMMITTED') ~> Transfer",
				"Transfer sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delimited',",
				"     container: 'datafactoryfiles',",
				"     folderPath: 'Transactions',",
				"     columnDelimiter: '|',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true,",
				"     partitionFileNames:[($FileNAme)],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     quoteAll: true) ~> sink1"
			]
		}
	}
}